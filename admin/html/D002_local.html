{% extends "local_mul.html" %}
{% block MUL_BTNS %}
{{BTNS}}
{% endblock %}


{% block mMul_Page_1 %}
<div class="panel-body">
    <div class="row">
        <div class="form-group" >
            <label class="col-sm-2 control-label"><b style="color:#333333;">非会员购物返积分比例:</b></label>
            <div class="col-sm-2">
                 <input type="number" class="form-control"  name="integral" value="{{item.integral}}"/>
                <font color="red">每消费1元返多少积分</font>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">会员购物返积分比例:</b></label>
            <div class="col-sm-2">
                 <input type="number" class="form-control"  name="vip_integral" value="{{item.vip_integral}}"/>
                <font color="red">每消费1元返多少积分</font>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">新用户注册送多少积分:</b></label>
            <div class="col-sm-2">
                 <input type="number" class="form-control"  name="new_score" value="{{item.new_score}}"/>
            </div>
        </div>
    </div>

    <br>
    <div class="row" style="display:;">

        <div class="col-sm-6">
            <div class="title_comm"><span class="block_blue"></span><b style="color:#333;">积分签到规则(签到天数空白的行不会保存,最多可以添加7条)</b>
                <span style="float:right">
                    <button class="btn btn-xs btn-info" type="button" onclick="add_r('detail')" title="增加">
                        <i class="fa fa-plus"></i>
                    </button>
                    <button class="btn btn-xs btn-warning" type="button" onclick="del_r('detail')" title="删除">
                        <i class="fa fa-trash-o"></i>
                    </button>
                </span>
            </div>
            <table class="table table-bordered addRowtb" name="detail">
                <thead>
                    <tr bgcolor="#ffffff">
                        <th style="text-align:center;width:60px;">序号</th>
                        <th style="text-align:center;width:260px;">签到天数</th>
                        <th style="text-align:center;width:250px;">赠送积分</th>

                    </tr>
                </thead>
                <tbody>

                    {% for e in detail %}
                        <tr>
                        <td onclick='clickR(this);'>{{loop.index}}</td>
                        <td onclick='clickR(this);'>
                            <input type='hidden' name='lid' value='{{e.id}}' />
                            <input type='number' name='days' value='{{e.days}}'  class='form-control' style='width:100%;' />
                        </td>
                        <td onclick='clickR(this);'><input type='number' name='score' value='{{e.score}}' class='form-control number' style='width:100%;ime-mode:Disabled;' /></td>
                        </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>
    </div>

</div>
<script>
$(function(){

 });


function add_r(tablename){

	var a= "show_option(this,'serlib','cgpm2')";
	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"
    if (rowNo>=8){
    return false;
    }
	html+="<td onclick='clickR(this);'>"+rowNo+"<input type='hidden' name='lid' value='' /></td>";
	html+="<td onclick='clickR(this);'><input type='number' name='days' value='' class='form-control' style='width:100%;'/></td>";
	html+="<td onclick='clickR(this);'><input type='number' name='score' value=''  class='form-control' style='width:100%;' /></td>";

	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.seltr');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}


function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('seltr');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('seltr');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>
{% endblock %}

{% block mMul_Page_2 %}
<div class="panel-body">
    <div class="row">
        <input type="hidden" name="lid" value="{{item.lid}}"/>
        <div class="form-group">
            <label class="col-sm-2 control-label">选择商品:</label>
            <div class="col-sm-6">
                <div class="col-sm-6">
                <input type="hidden" name="goods_id" value="{{item.goods_id}}"/>
                <input type="text" class="form-control"  name="good_name" value="{{item.good_name}}" readonly="1"/>
                </div>
                <div class="col-sm-4">{{jf_mselect}}</div>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">兑换所需积分:</label>
            <div class="col-sm-3">
                <input type="number" class="form-control"  name="score" value="{{item.score}}" />
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">限量多少件:</label>
            <div class="col-sm-3">
                <input type="number" class="form-control"  name="amount" value="{{item.amount}}" />
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">最大兑换数量:</label>
            <div class="col-sm-3">
                <input type="number" class="form-control"  name="max_amount" value="{{item.max_amount}}" />
            </div>
        </div>

    </div>
    <div class="row">
        <div class="col-sm-12">
            <div class="title_comm">
                <span class="block_blue"></span>
                <b style="color:#333;">积分商品列表</b>&emsp;&emsp;

            </div>
            <table class="table table-bordered addRowtb" name="detail">
                <thead>
                    <tr bgcolor="#ffffff">
                        <th style="text-align:center;width:5%;">商品ID</th>
                        <th style="text-align:center;width:25%;">商品名称</th>
                        <th style="text-align:center;width:10%;">所需积分</th>
                        <th style="text-align:center;width:10%;">总数量</th>
                        <th style="text-align:center;width:10%;">最大兑换数量</th>
                        <th style="text-align:center;width:10%;">剩余数量</th>
                        <th style="text-align:center;width:15%;">状态</th>
                        <th style="text-align:center;width:15%;">操作</th>
                    </tr>
                </thead>
                <tbody>

                    {% for r in detail %}
                        <tr>
                            {%for e in r[1:]%}
                            <td>
                                {{e}}
                            </td>
                            {%endfor%}
                            <td>
                                未处理
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>
    </div>


</div>
<script>

function add_r(tablename){

	var a= "show_option(this,'serlib','cgpm2')";
	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"

	html+="<td onclick='clickR(this);'>"+rowNo+"<input type='hidden' name='lid' value='' /></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='cname' value='' class='form-control' style='width:100%;'/></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='address' value=''  class='form-control' style='width:100%;' /></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='contact' value='' class='form-control number' /></td>";
    html+="<td onclick='clickR(this);'><div class='col-sm-6'>经度<input type='text' name='jd' value='' class='form-control'  /></div>";
    html+="<div class='col-sm-6'>纬度<input type='text' name='wd' value='' class='form-control' /></div></td>";
	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.alert-warning');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}


function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('alert-warning');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('seltr');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>

{% endblock %}

{% block mMul_Page_3 %}

<div class="panel-body">
    <div class="row">
        <div class="form-group">
            <label class="col-sm-2 control-label">订单包邮金额(元):</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="use_money" value="{{item.use_money}}" onkeyup="value=value.replace(/[^\d]/g,'')"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">订单关闭时间(分钟):</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="close_time" value="{{item.close_time}}" onkeyup="value=value.replace(/[^\d]/g,'')"/>
            </div>
        </div>

    </div>
    <div class="row">
        <div class="col-sm-12">
            <label ><b style="color:#333333;">订单模板消息ID:</b></label>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" >订单取消通知:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="cancel_id" value="{{item.cancel_id}}"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">订单发货通知:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="send_id" value="{{item.send_id}}"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">订单评价通知:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="evaluate_id" value="{{item.evaluate_id}}"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">订单完成通知:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="complete_id" value="{{item.complete_id}}"/>
            </div>
        </div>
    </div>
    <div class="row">

        <div class="col-sm-12">
            <div class="title_comm"><b style="color:#333;">订单配送方式</b>
                {#
                <span style="float:right">
                    <button class="btn btn-xs btn-info" type="button" onclick="add_r('detail')" title="增加">
                        <i class="fa fa-plus"></i>
                    </button>
                    <button class="btn btn-xs btn-warning" type="button" onclick="del_r('detail')" title="删除">
                        <i class="fa fa-trash-o"></i>
                    </button>
                </span>
                #}
            </div>
        </div>

        <div class="col-sm-12">
            <table class="table table-bordered addRowtb" >
                <thead>
                    <tr bgcolor="#ffffff">
                        <th class="col-sm-1" style="text-align:center;">运送方式</th>
                        <th class="col-sm-1" style="text-align:center;">是否包邮</th>
                        <th class="col-sm-1" style="text-align:center;">计价方式</th>
                        <th class="col-sm-5" style="text-align:center;">运费设置</th>
                        <th class="col-sm-1" style="text-align:center;">是否启用</th>
                        <th class="col-sm-1" style="text-align:center;">是否默认</th>
                    </tr>
                </thead>
                <tbody id="peisong">
                {%if detail%}
                {% for r in detail%}
                <tr class="alert-warning">
                    {%if r.c_id|string=='0'%}
                    <td>
                        <input type="hidden" name="lid" value="{{r.id}}">
                        <input type="hidden" name="c_id" value="0" />
                        <input type="text" name="cname" value="快递配送" class="form-control" readonly="readonly" />
                    </td>

                    <td>
                        <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                            <option value="0" {{' selected="selected"' if r.is_mail|string == '0'}}>不包邮</option>
                            <option value="1" {{' selected="selected"' if r.is_mail|string == '1'}}>包邮</option>
                        </select>
                    </td>
                    <td>
                        <select name="counts" class="form-control" id='set_mail_1'>
                            <option value="0" {{' selected="selected"' if r.counts|string == '0'}}>按件</option>
                            <option value="1" {{' selected="selected"' if r.counts|string == '1'}}>按重量</option>
                        </select>
                    </td>

                    <td>
                        <div id='set_mail_2'>
                        <input type="number" name="piece" value="{{r.piece}}" style="width:50px;" />件(KG)内
                        <input type="number" name="only_money" value="{{r.only_money}}" style="width:50px;" />元，
                        每增加<input type="number" name="add_piece" value="{{r.add_piece}}" style="width:50px;" />件(KG),增加运费
                        <input type="number" name="add_money" value="{{r.add_money}}" style="width:50px;" />元
                        </div>
                    </td>
                    <td>
                        <input type="hidden" name="status_str" value="">
                        <select name="status" class="form-control">
                            <option value="0" {{' selected="selected"' if r.status|string == '0'}}>否</option>
                            <option value="1" {{' selected="selected"' if r.status|string == '1'}}>是</option>
                        </select>

                    </td>
                    <td>
                        <input type="checkbox" name="default" value="0" onclick="set_default(this)" {{' checked="checked"' if r.is_default|string == '1'}}/>
                    </td>
                    {%endif%}
                </tr>
                <tr class="alert-warning">
                    {%if r.c_id|string=='1'%}
                    <td>
                        <input type="hidden" name="lid" value="{{r.id}}">
                        <input type="hidden" name="c_id" value="1" />
                        <input type="text" name="cname" value="上门自提" class="form-control" readonly="readonly">
                    </td>

                    <td>
                        <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                            <option value="0" {{' selected="selected"' if r.is_mail|string == '0'}}>不包邮</option>
                            <option value="1" {{' selected="selected"' if r.is_mail|string == '1'}}>包邮</option>
                        </select>
                    </td>
                    <td>
                        <select name="counts" class="form-control" id='set_mail_1'>
                            <option value="0" {{' selected="selected"' if r.counts|string == '0'}}>按件</option>
                            <option value="1" {{' selected="selected"' if r.counts|string == '1'}}>按重量</option>
                        </select>
                    </td>

                    <td>
                        <div id='set_mail_2'>
                        <input type="number" name="piece" value="{{r.piece}}" style="width:50px;" />件(KG)内
                        <input type="number" name="only_money" value="{{r.only_money}}" style="width:50px;" />元，
                        每增加<input type="number" name="add_piece" value="{{r.add_piece}}" style="width:50px;" />件(KG),增加运费
                        <input type="number" name="add_money" value="{{r.add_money}}" style="width:50px;" />元
                        </div>
                    </td>
                    <td>
                        <select name="status" class="form-control">
                            <option value="0" {{' selected="selected"' if r.status|string == '0'}}>否</option>
                            <option value="1" {{' selected="selected"' if r.status|string == '1'}}>是</option>
                        </select>
                    </td>
                    <td>
                        <input type="checkbox" name="default" value="1" onclick="set_default(this)" {{' checked="checked"' if r.is_default|string == '1'}}/>
                    </td>
                    {%endif%}
                </tr>
                <tr class="alert-warning">
                    {%if r.c_id|string=='2'%}
                    <td>
                        <input type="hidden" name="lid" value="{{r.id}}">
                        <input type="hidden" name="c_id" value="2" />
                        <input type="text" name="cname" value="无需配送" class="form-control" readonly="readonly">
                    </td>

                    <td>
                        <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                            <option value="0" {{' selected="selected"' if r.is_mail|string == '0'}}>不包邮</option>
                            <option value="1" {{' selected="selected"' if r.is_mail|string == '1'}}>包邮</option>
                        </select>
                    </td>
                    <td>
                        <select name="counts" class="form-control" id='set_mail_1'>
                            <option value="0" {{' selected="selected"' if r.counts|string == '0'}}>按件</option>
                            <option value="1" {{' selected="selected"' if r.counts|string == '1'}}>按重量</option>
                        </select>
                    </td>

                    <td>
                        <div id='set_mail_2'>
                        <input type="number" name="piece" value="{{r.piece}}" style="width:50px;" />件(KG)内
                        <input type="number" name="only_money" value="{{r.only_money}}" style="width:50px;" />元，
                        每增加<input type="number" name="add_piece" value="{{r.add_piece}}" style="width:50px;" />件(KG),增加运费
                        <input type="number" name="add_money" value="{{r.add_money}}" style="width:50px;" />元
                        </div>
                    </td>
                    <td>
                        <select name="status" class="form-control">
                            <option value="0" {{' selected="selected"' if r.status|string == '0'}}>否</option>
                            <option value="1" {{' selected="selected"' if r.status|string == '1'}}>是</option>
                        </select>
                    </td>
                    <td>
                        <input type="checkbox" name="default" value="2" onclick="set_default(this)" {{' checked="checked"' if r.is_default|string == '1'}}/>
                    </td>
                    {%endif%}
                </tr>
                {%endfor%}
                {%else%}

                <tr class="alert-warning">

                    <td>
                        <input type="hidden" name="lid" value="">
                        <input type="hidden" name="c_id" value="0" />
                        <input type="text" name="cname" value="快递配送" class="form-control" readonly="readonly" />
                    </td>

                    <td>
                        <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                            <option value="0" >不包邮</option>
                            <option value="1" selected="selected">包邮</option>
                        </select>
                    </td>

                    <td>
                        <select name="counts" class="form-control" id='set_mail_1'>
                            <option value="0" >按件</option>
                            <option value="1" >按重量</option>
                        </select>
                    </td>

                    <td>
                        <div id='set_mail_2'>
                        <input type="number" name="piece" value="" style="width:50px;" />件(KG)内
                        <input type="number" name="only_money" value="" style="width:50px;" />元，
                        每增加<input type="number" name="add_piece" value="" style="width:50px;" />件(KG),增加运费
                        <input type="number" name="add_money" value="" style="width:50px;" />元
                        </div>
                    </td>
                    <td>
                        <input type="hidden" name="status_str" value="">
                        <select name="status" class="form-control">
                            <option value="0" >否</option>
                            <option value="1" >是</option>
                        </select>
                    </td>
                    <td>
                        <input type="checkbox" name="default" value="0" onclick="set_default(this)" />
                    </td>

                </tr>
                <tr class="alert-warning">

                    <td>
                        <input type="hidden" name="lid" value="">
                        <input type="hidden" name="c_id" value="1" />
                        <input type="text" name="cname" value="上门自提" class="form-control" readonly="readonly">
                    </td>

                    <td>
                        <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                            <option value="0" >不包邮</option>
                            <option value="1" selected="selected">包邮</option>
                        </select>
                    </td>
                    <td>
                        <select name="counts" class="form-control" id='set_mail_1'>
                            <option value="0" >按件</option>
                            <option value="1" >按重量</option>
                        </select>
                    </td>

                    <td>
                        <div id='set_mail_2'>
                        <input type="number" name="piece" value="" style="width:50px;" />件(KG)内
                        <input type="number" name="only_money" value="" style="width:50px;" />元，
                        每增加<input type="number" name="add_piece" value="" style="width:50px;" />件(KG),增加运费
                        <input type="number" name="add_money" value="" style="width:50px;" />元
                        </div>
                    </td>
                    <td>
                        <select name="status" class="form-control">
                            <option value="0" >否</option>
                            <option value="1">是</option>
                        </select>
                    </td>
                    <td>
                        <input type="checkbox" name="default" value="1" onclick="set_default(this)"/>
                    </td>

                </tr>
                <tr class="alert-warning">

                    <td>
                        <input type="hidden" name="lid" value="">
                        <input type="hidden" name="c_id" value="2" />
                        <input type="text" name="cname" value="无需配送" class="form-control" readonly="readonly">
                    </td>

                    <td>
                        <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                            <option value="0" >不包邮</option>
                            <option value="1" selected="selected">包邮</option>
                        </select>
                    </td>
                    <td>
                        <select name="counts" class="form-control" id='set_mail_1'>
                            <option value="0" >按件</option>
                            <option value="1" >按重量</option>
                        </select>
                    </td>

                    <td>
                        <div id='set_mail_2'>
                        <input type="number" name="piece" value="" style="width:50px;" />件(KG)内
                        <input type="number" name="only_money" value="" style="width:50px;" />元，
                        每增加<input type="number" name="add_piece" value="" style="width:50px;" />件(KG),增加运费
                        <input type="number" name="add_money" value="" style="width:50px;" />元
                        </div>
                    </td>
                    <td>
                        <select name="status" class="form-control">
                            <option value="0">否</option>
                            <option value="1">是</option>
                        </select>
                    </td>
                    <td>
                        <input type="checkbox" name="default" value="2" onclick="set_default(this)" />
                    </td>
                </tr>

                {%endif%}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
$(function(){
    var tr =$('#peisong').find('tr');
	for(var i = 0;i < tr.length;i++){
        var firstTdText = tr.eq(i).find('td').eq(1).find('select').val();
        if(firstTdText=='1'){
            tr.eq(i).find('#set_mail_1').hide();
            tr.eq(i).find('#set_mail_2').hide();
        }else{
            tr.eq(i).find('#set_mail_1').show();
            tr.eq(i).find('#set_mail_2').show();
        }

    }

 });
function set_is_mail(obj){
    var tr =$('#peisong').find('tr');
    var index=tr.index($(obj).closest("tr"));
    var a=obj.value;
    if (a=='0'){
        tr.eq(index).find('#set_mail_1').show();
        tr.eq(index).find('#set_mail_2').show();
        tr.eq(index).find('td').eq(3).find('input').val('');
    }else{
        tr.eq(index).find('#set_mail_1').hide();
        tr.eq(index).find('#set_mail_2').hide();
        tr.eq(index).find('td').eq(3).find('input').val('');
    }
}

function set_default(obj){

    if(obj.checked){
         $('input[name=default]').prop('checked', false);
         $(obj).prop('checked',true);
    }

}
function add_r(tablename){

	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"

	html+="<td onclick='clickR(this);'><input type='hidden' name='lid' value='' />";
	html+="<input type='text' name='cname' value='' class='form-control'/></td>";

	html+="<td onclick='clickR(this);'><select name='is_mail'  class='form-control' onchange='set_is_mail(this)'>";
    html+="<option value='0'>不包邮</option>";
    html+="<option value='1'>包邮</option>";
    html+="</select></td>";

	html+="<td onclick='clickR(this);'><select name='counts'  class='form-control' id='set_mail_1'>"
	html+="<option value='0'>按件</option>";
    html+="<option value='1'>按重量</option>";
    html+="</select></td>";

	html+="<td onclick='clickR(this);'><div id='set_mail_2'>"
	html+='<input type="number" name="piece" value=""   style="width:50px;" />件(KG)内';
	html+='<input type="number" name="only_money" value=""   style="width:50px;" />元，<br>';
	html+='每增加<input type="number" name="add_piece" value=""  style="width:50px;"/>件(KG),';
    html+='增加运费<input type="number" name="add_money" value=""  style="width:50px;" />元';
	html+="</div></td>";

	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.alert-warning');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}

function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('alert-warning');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('alert-warning');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>
{% endblock %}


{% block mMul_Page_4 %}
<div class="panel-body">
    <div class="row">
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">小程序appid:</b></label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="appid" value="{{item.appid}}"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">小程序secret:</b></label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="secret" value="{{item.secret}}"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">微信支付商户号:</b></label>
            <div class="col-sm-3">
                 <input type="text" class="form-control"  name="mchid" value="{{item.mchid}}"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">微信支付秘钥:</b></label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="mchkey" value="{{item.mchkey}}"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">微信支付回调域名:</b></label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="base_url" value="{{item.base_url}}"/>
            <font style="color:red;font-size:18px;">如:https://malishop.janedao.cn</font>
            </div>
        </div>
         <!--div class="form-group">
            <label class="col-sm-2 control-label">微信支付证书:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="certificate" value="{{item.certificate}}"/>
            <font color="red">此项暂时未处理</font>
            </div>
        </div-->


    </div>





</div>
{% endblock %}

{% block mMul_Page_5 %}
<div class="panel-body">
    <div class="row">

        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">会员升级方式:</b></label>
            <input type="hidden"  name="up_type_str" value="{{item.up_type_str or '付费升级'}}"/>
            <div class="col-sm-3">
                <select name="up_type"  class="form-control" onchange="set_up_type(this)">
				<option value="1"{{' selected="selected"' if item.up_type|string == '1'}}>付费升级</option>
				<option value="2"{{' selected="selected"' if item.up_type|string == '2'}}>购物升级</option>
			</select>
            </div>
        </div>
        <div class="form-group" id="up_type_3">
            <label class="col-sm-2 control-label"><b style="color:#333333;">年费会员价格(元):</b></label>
            <div class="col-sm-3">
                 <input type="number" class="form-control"  name="vip_price" value="{{item.vip_price}}"/>
            </div>
        </div>
        <div class="form-group" id="up_type_1">
            <label class="col-sm-2 control-label"><b style="color:#333333;">会员折扣百分比(%):</b></label>
            <div class="col-sm-3">
                 <input type="number" class="form-control"  name="discount" value="{{item.discount}}"/>
            </div>
        </div>
    </div>

    <br>
    <div class="row" id="up_type_2" style="display:none;">

        <div class="col-sm-12">
            <div class="title_comm"><span class="block_blue"></span><b style="color:#333;">会员级别设置(名称空白的行不会保存)</b>
                <span style="float:right">
                    <button class="btn btn-xs btn-info" type="button" onclick="add_r('detail')" title="增加">
                        <i class="fa fa-plus"></i>
                    </button>
                    <button class="btn btn-xs btn-warning" type="button" onclick="del_r('detail')" title="删除">
                        <i class="fa fa-trash-o"></i>
                    </button>
                </span>
            </div>
            <table class="table table-bordered addRowtb" name="detail">
                <thead>
                    <tr bgcolor="#ffffff">
                        <th style="text-align:center;width:60px;">序号</th>
                        <th style="text-align:center;width:260px;">级别名称</th>
                        <th style="text-align:center;width:250px;">升级价格(元)</th>
                        <th style="text-align:center;width:80px;">级别折扣(%)</th>
                    </tr>
                </thead>
                <tbody>

                    {% for e in detail %}
                        <tr>
                        <td onclick='clickR(this);'>{{loop.index}}<input type='hidden' name='lid' value='{{e.id}}' /></td>
                        <td onclick='clickR(this);'><input type='text' name='cname' value='{{e.cname}}' class='form-control' style='width:100%;'/></td>
                        <td onclick='clickR(this);'><input type='number' name='up_price' value='{{e.up_price}}'  class='form-control' style='width:100%;' /></td>
                        <td onclick='clickR(this);'><input type='number' name='level_discount' value='{{e.level_discount}}' class='form-control number' style='width:100%;ime-mode:Disabled;' /></td>
                        </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>
    </div>

</div>
<script>
$(function(){
    if($('select[name=up_type]').val()=='1'){
        $('#up_type_2').hide()
        $('#up_type_1').show()
        $('#up_type_3').show()
    }else{
        $('#up_type_2').show()
        $('#up_type_1').hide()
         $('#up_type_3').hide()
    }
 });
function set_up_type(obj){
    var hid=obj.value;
    layer.confirm('变更会员升级方式会带来不可逆的后果,您确信要变更吗？', {
			btn: ['是','否'] //按钮
		}, function(index,layero){
			 layer.close(index)
			 if (hid=='1'){
                    $('input[name=up_type_str]').val('付费升级');
                    $('#up_type_2').hide()
                    $('#up_type_1').show()
                    $('#up_type_3').show()
                }else{
                    $('input[name=up_type_str]').val('购物升级');
                    $('#up_type_2').show()
                    $('#up_type_1').hide()
                    $('#up_type_3').hide()
                }


		}, function(){
			if (hid=='1'){
                $('select[name=up_type]').val('2');
            }else{
               $('select[name=up_type]').val('1');
            }
		});
    /*layer.msg('变更会员升级方式会带来不可逆的后果')
    if (hid=='1'){
        $('input[name=up_type_str]').val('付费升级');
        $('#up_type_2').hide()
    }else{
        $('input[name=up_type_str]').val('购物升级');
        $('#up_type_2').show()
    }*/
    //console.log($('select[name=up_type]').val())
}

function add_r(tablename){

	var a= "show_option(this,'serlib','cgpm2')";
	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"

	html+="<td onclick='clickR(this);'>"+rowNo+"<input type='hidden' name='lid' value='' /></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='cname' value='' class='form-control' style='width:100%;'/></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='up_price' value=''  class='form-control' style='width:100%;' /></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='level_discount' value='' class='form-control number' /></td>";

	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.alert-warning');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}


function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('alert-warning');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('seltr');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>
{% endblock %}

{% block mMul_Page_6 %}
<link rel="stylesheet" type="text/css" href="static/asset/liger/ligerUI/skins/Aqua/css/ligerui-all.css">
<link rel="stylesheet" type="text/css" href="static/asset/liger/ligerUI/skins/Aqua/css/ligerui-layout.css">
<link rel="stylesheet" type="text/css" href="static/asset/liger/ligerUI/skins/Aqua/css/ligerui-grid.css">
<link rel="stylesheet" type="text/css" href="static/asset/liger/ligerUI/skins/Aqua/css/ligerui-common.css">
<script type="text/javascript" src="static/asset/liger/ligerUI/js/core/base.js"></script>
<script type="text/javascript" src="static/asset/liger/ligerUI/js/plugins/ligerTree.js"></script>
<script type="text/javascript" src="static/asset/liger/ligerUI/js/plugins/ligerGrid.js"></script>
<script type="text/javascript" src="static/asset/liger/ligerUI/js/plugins/ligerResizable.js"></script>
<script type="text/javascript" src="static/asset/liger/ligerUI/js/plugins/ligerDialog.js"></script>
<script type="text/javascript" src="static/asset/liger/ligerUI/js/plugins/ligerMenu.js"></script>
<script type="text/javascript" src="static/asset/liger/ligerUI/js/plugins/ligerSpinner.js"></script>
<script type="text/javascript" src="static/asset/liger/ligerUI/js/plugins/ligerDrag.js"></script>
<script type="text/javascript" src="static/asset/liger/ligerUI/js/plugins/ligerFilter.js"></script>
<script type="text/javascript" src="static/asset/liger/ligerUI/js/plugins/ligerToolBar.js"></script>
<script src="static/asset/liger/ligerUI/js/plugins/ligerComboBox.js" type="text/javascript"></script>
<div class="panel-body">
    <div class="row">
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">首页推荐商品设置:</b></label>
            <input type="hidden"  name="home_goods_str" value="{{item.home_goods_str or '全部商品'}}"/>
            <div class="col-sm-3">
                <select name="home_goods"  class="form-control" onchange="set_home_goods(this);">
                    <option value="0"{{' selected="selected"' if item.home_goods|string == '0'}}>全部商品</option>
                    <option value="1"{{' selected="selected"' if item.home_goods|string == '1'}}>指定商品</option>
                </select>
            </div>
            <div class="col-sm-6" id="home_page" style="display:none">
                 <input type="text" class="form-control"  name="goods_id" value="{{item.home_goods_id}}" readonly="readonly"/>
                {{show_Goods}}
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">购物车推荐商品设置:</b></label>
            <input type="hidden"  name="shop_goods_str" value="{{item.shop_goods_str or '全部商品'}}"/>
            <div class="col-sm-3">
                <select name="shop_goods"  class="form-control" onchange="set_shop_goods(this);">
                    <option value="0"{{' selected="selected"' if item.shop_goods|string == '0'}}>全部商品</option>
                    <option value="1"{{' selected="selected"' if item.shop_goods|string == '1'}}>指定商品</option>
                </select>
            </div>
            <div class="col-sm-6" id="shop_cart" style="display:none">
                 <input type="text" class="form-control"  name="goods_ids" value="{{item.shop_goods_id}}" readonly="readonly"/>
                {{show_Goods_id}}
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">订单页推荐商品设置:</b></label>
            <input type="hidden"  name="order_goods_str" value="{{item.order_goods_str or '全部商品'}}"/>
            <div class="col-sm-3">
                <select name="order_goods"  class="form-control" onchange="set_order_goods(this);">
                    <option value="0"{{' selected="selected"' if item.order_goods|string == '0'}}>全部商品</option>
                    <option value="1"{{' selected="selected"' if item.order_goods|string == '1'}}>指定商品</option>
                </select>
            </div>
            <div class="col-sm-6" id="shop_order" style="display:none">
                 <input type="text" class="form-control"  name="order_goods_id" value="{{item.order_goods_id}}" readonly="readonly"/>
                {{order_Goods_id}}
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label"><b style="color:#333333;">购物车页信息设置(多个用逗号隔开):</b></label>
            <div class="col-sm-8">
                <input type="text"  name="shop_cart_memo" class="form-control" value="{{item.shop_cart_memo}}"/>
            </div>

        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label"><b style="color:#333333;">菜单页面搜索关键词设置(多个用逗号隔开):</b></label>
            <div class="col-sm-8">
                <input type="text"  name="menu_memo" class="form-control" value="{{item.menu_memo}}"/>
            </div>

        </div>
    </div>
</div>
<script>

$(function(){

    if($('select[name=home_goods]').val()=='0'){
        $('#home_page').hide()
    }else{
        $('#home_page').show()
    }

    if($('select[name=shop_goods]').val()=='0'){
        $('#shop_cart').hide()
    }else{
        $('#shop_cart').show()
    }

    if($('select[name=order_goods]').val()=='0'){
        $('#shop_order').hide()
    }else{
        $('#shop_order').show()
    }
 });
function set_home_goods(obj){
    var hid=obj.value;
    if (hid=='1'){
        $('input[name=home_goods_str]').val('指定商品');
        $('#home_page').show()
        $('input[name=goods_id]').val('')
    }else{
        $('input[name=home_goods_str]').val('全部商品');
       $('#home_page').hide()
       $('input[name=goods_id]').val('0')
    }
}

function set_shop_goods(obj){
    var sid=obj.value;
    if (sid=='1'){
        $('input[name=shop_goods_str]').val('指定商品');
        $('#shop_cart').show()
        $('input[name=goods_ids]').val('')
    }else{
        $('input[name=shop_goods_str]').val('全部商品');
       $('#shop_cart').hide()
       $('input[name=goods_ids]').val('0')
    }
}

function set_order_goods(obj){
    var oid=obj.value;
    if (oid=='1'){
        $('input[name=order_goods_str]').val('指定商品');
        $('#shop_order').show()
        $('input[name=order_goods_id]').val('')
    }else{
        $('input[name=order_goods_str]').val('全部商品');
       $('#shop_order').hide()
       $('input[name=order_goods_id]').val('0')
    }
}


function add_r(tablename){

	var a= "show_option(this,'serlib','cgpm2')";
	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"

	html+="<td onclick='clickR(this);'>"+rowNo+"<input type='hidden' name='lid' value='' /></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='memo' value='' class='form-control' style='width:100%;'/></td>";
	//html+="<td onclick='clickR(this);'><input type='text' name='up_price' value=''  class='form-control' style='width:100%;' /></td>";
	//html+="<td onclick='clickR(this);'><input type='text' name='level_discount' value='' class='form-control number' /></td>";

	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.alert-warning');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}


function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('alert-warning');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('seltr');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>
{% endblock %}

{% block page_script %}
<script type="text/javascript">
if({{save_alert}}==1){
	layer.alert('保存成功!',{yes:function(){
         window.location = 'admin?viewid={{viewid}}&part=localfrm&tab={{tab}}';
   }});
}else if ({{save_alert}}==2){
    layer.alert('保存失败!',{yes:function(){
         window.location = 'admin?viewid={{viewid}}&part=localfrm&tab={{tab}}';
   }});
}
</script>
<script>
    function formcheck_2(form){

        return true;

    }

</script>
{% endblock %}